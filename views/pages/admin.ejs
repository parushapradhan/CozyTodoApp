<%- include('../partials/header'); %>

<div class="auth-container">
  <h2>ğŸ‘‘ Admin Panel</h2>

  <% users.forEach(user => { %>
  <div class="user-card">
    <h3><%= user.username %> (Level <%= user.music_settings.level %>)</h3>
    <p><strong>Email:</strong> <%= user.email %></p>
    <p><strong>XP:</strong> <%= user.music_settings.exp %></p>

    <!-- Delete User Form -->
    <form action="/admin/delete-user" method="POST" style="display: inline">
      <input type="hidden" name="email" value="<%= user.email %>" />
      <button type="submit">ğŸ—‘ï¸ Delete User</button>
    </form>

    <!-- Update Level Form -->
    <form action="/admin/update-level" method="POST" style="margin-top: 10px">
      <input type="hidden" name="email" value="<%= user.email %>" />
      <input type="number" name="level" placeholder="New Level" required />
      <button type="submit">ğŸ”¼ Update Level</button>
    </form>

    <!-- Tasks List -->
    <p><strong>Tasks:</strong></p>
    <ul>
      <% if (user.music_settings.tasks && user.music_settings.tasks.length > 0)
      { %> <% user.music_settings.tasks.forEach(task => { %>
      <li>
        <%= task.task_name %>
        <form action="/admin/remove-task" method="POST" style="display: inline">
          <input type="hidden" name="email" value="<%= user.email %>" />
          <input type="hidden" name="task" value="<%= task.task_name %>" />
          <button type="submit">âŒ</button>
        </form>
      </li>
      <% }) %> <% } else { %>
      <li>No tasks</li>
      <% } %>
    </ul>

    <hr />
  </div>
  <% }) %>
</div>
